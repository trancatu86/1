Private Sub Worksheet_Change(ByVal Target As Range)
    Dim ws1 As Worksheet, ws2 As Worksheet, ws3 As Worksheet, ws4 As Worksheet
    Dim checkCell As Range

    ' Xác định ô cần kiểm tra (thay đổi A1 thành ô bạn muốn theo dõi)
    Set checkCell = Me.Range("A1")

    ' Xác định các sheet
    Set ws1 = ThisWorkbook.Sheets("Sheet1")
    Set ws2 = ThisWorkbook.Sheets("Sheet2")
    Set ws3 = ThisWorkbook.Sheets("Sheet3")
    Set ws4 = ThisWorkbook.Sheets("Sheet4")

    ' Kiểm tra xem ô được thay đổi có phải là ô cần kiểm tra không
    If Not Intersect(Target, checkCell) Is Nothing Then
        Application.EnableEvents = False ' Ngăn vòng lặp vô hạn

        ' Nếu giá trị ô là "a"
        If LCase(checkCell.Value) = "a" Then
            ws1.Visible = xlSheetVisible ' Hiển thị Sheet1
            ws2.Visible = xlSheetVisible ' Hiển thị Sheet2
            ws3.Visible = xlSheetHidden  ' Ẩn Sheet3
            ws4.Visible = xlSheetHidden  ' Ẩn Sheet4
        Else
            ' Khôi phục trạng thái mặc định nếu giá trị không phải "a"
            ws1.Visible = xlSheetHidden
            ws2.Visible = xlSheetHidden
            ws3.Visible = xlSheetVisible
            ws4.Visible = xlSheetVisible
        End If

        Application.EnableEvents = True ' Bật lại sự kiện
    End If
End Sub
