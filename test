import pandas as pd

# Đọc dữ liệu từ file CSV
file_path = 'acceleration_data.csv'
data = pd.read_csv(file_path)

# Tạo file punch
punch_file_path = 'acceleration_output.pch'
with open(punch_file_path, 'w') as f:
    f.write('$ ACCELERATIONS (REAL)\n')
    
    # Ghi giá trị thực vào file punch
    for index, row in data.iterrows():
        frequency = row['Frequency']
        real_value = row['Real']
        f.write(f'{index+1:>8} {1:<6} {real_value:>20.6E}\n')  # Cột ID là index+1, DOF = 1

    f.write('$ ACCELERATIONS (IMAGINARY)\n')
    
    # Ghi giá trị ảo vào file punch
    for index, row in data.iterrows():
        frequency = row['Frequency']
        imaginary_value = row['Imaginary']
        f.write(f'{index+1:>8} {1:<6} {imaginary_value:>20.6E}\n')  # Cột ID là index+1, DOF = 1

print(f'File punch đã được tạo thành công tại: {punch_file_path}')
